{% extends "campaigns/wizard_base.html" %}


{% block content_title %}New Conversation{% endblock %}

{% block content_main %}
<form id="frm-conversation-details" class="indent" method="post" action="">
    {% csrf_token %}
    <fieldset>
        {% for field in form_general.visible_fields %}
        <div class="control-group{% if field.errors %} error{% endif %}">
            <label class="control-label" for="id_{{ field.name }}">
                {{ field.label }}
            </label>
            <div class="controls">
                {{ field }}
                <span class="help-inline">
                    {% if field.errors %}
                        {{ field.errors|join:" " }}
                    {% endif %}
                    {% if field.help_text %}
                        ({{ field.help_text }})
                    {% endif %}
                </span>
            </div>
        </div>
        {% endfor %}
    </fieldset>


    
    <div class="configuration">

        <label class="control-label">
            How would you like to reach and interact with users?
        </label>

        {# TODO: This is where Justin's jsPlumb stuff will come? #}
        <fieldset class="configuration_new row-fluid boxes">
            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.countries.name }}">
                        {{ form_config_new.countries.label }}
                    </label>

                    {{ form_config_new.countries }}
                </div>
                <button class="btn btn-primary">Add country</button>
            </div>

            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.keyword.name }}">
                      {{ form_config_new.channels.label }}
                    </label>
                    {{ form_config_new.channels }}
                </div>
                <button class="btn btn-primary">Add channel</button>
            </div>
            
            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.keyword.name }}">
                      {{ form_config_new.keyword.label }}
                    </label>
                    {{ form_config_new.keyword }}
                </div>
            </div>
        </fieldset>

        {# TODO: Connect the real form here. #}
        <fieldset class="configuration_existing row-fluid boxes">
            <div class="span4">
                <div class="box">
                    <label for="id_channel">
                        Select an existing channel
                    </label>
                    <select name="channel" id="id_channel">
                        <option value=""></option>
                        <option value="">Channel A</option>
                        <option value="">Channel B</option>
                    </select>
                </div>
            </div>

            <div class="span4">
                <div class="box">
                    <label for="id_keyword">
                      Define a new keyword
                    </label>
                    <input type="text" name="keyword" id="id_keyword">
                </div>
            </div>
            
            <div class="span4">
                <div class="box">
                    <label for="">
                      Your existing keywords
                    </label>

                    Dan, Sam, Plan, Rodger.
                </div>
            </div>
        </fieldset>

    </div>
</form>
{% endblock %}


{% block ondomready %}
    {{ block.super }}
    
    
    // if a channel is already selected then we should show the
    // configuration view for it.
    $('input[name=channel]:checked').trigger('change')

    $('input[name=channel]').on('change', function() {
        // hide both
        $('.configuration').show()
        $('.configuration fieldset').hide();
        var $el = $('.configuration_' + $(this).attr('value'));
        $el.show();
    });


{% endblock %}
